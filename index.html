<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ù–µ–º—Å–∫–∏ –†–µ–∫—Ü–∏–∏ 255 - Fixed</title>
    <style>
        :root { --p: #1a2a6c; --s: #b21f1f; --ok: #4caf50; --err: #f44336; --akk: #007bff; --dat: #dc3545; }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
        body { font-family: -apple-system, system-ui, sans-serif; background: #f0f2f5; padding: 10px; color: #333; }
        .container { max-width: 500px; margin: 0 auto; }
        .stats { display: flex; justify-content: space-around; background: #333; color: #fff; padding: 12px; border-radius: 12px; margin-bottom: 10px; font-weight: bold; }
        .panel { background: #fff; padding: 10px; border-radius: 15px; margin-bottom: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .btn-group { display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 5px; }
        button { cursor: pointer; border: 2px solid var(--p); background: #fff; border-radius: 10px; font-weight: bold; transition: 0.2s; outline: none; }
        .tgl { flex: 1; padding: 12px 5px; font-size: 0.75rem; text-transform: uppercase; }
        .tgl.active { background: var(--p); color: #fff; }
        .flip-container { perspective: 1000px; width: 100%; height: 250px; margin-bottom: 15px; }
        .flip-inner { position: relative; width: 100%; height: 100%; transition: transform 0.4s; transform-style: preserve-3d; }
        .flipped .flip-inner { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; text-align: center; padding: 20px; border-radius: 20px; background: #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); font-size: 1.4rem; font-weight: bold; }
        .card-back { transform: rotateY(180deg); background: #f9f9f9; color: var(--p); }
        .main-card { background: #fff; border-radius: 20px; padding: 20px; min-height: 300px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); display: none; flex-direction: column; align-items: center; justify-content: center; }
        .opt-grid { display: grid; grid-template-columns: 1fr; gap: 8px; width: 100%; margin-top: 15px; }
        .opt { padding: 15px; text-align: left; border-color: #eee; font-size: 0.95rem; }
        .opt.correct { background: var(--ok) !important; color: #fff; border-color: var(--ok); }
        .opt.wrong { background: var(--err) !important; color: #fff; border-color: var(--err); }
        .txt-akk { color: var(--akk); font-weight: bold; } .txt-dat { color: var(--dat); font-weight: bold; }
        input[type="text"] { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 12px; font-size: 1.1rem; text-align: center; }
        #ar-search { width: 100%; padding: 12px; border: 2px solid var(--p); border-radius: 10px; margin-bottom: 10px; }
        #ar-list { max-height: 350px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .ar-item { padding: 10px; border-bottom: 1px solid #eee; display: flex; flex-direction: column; }
        .nav { display: flex; gap: 10px; margin-top: 10px; }
        .btn-nav { flex: 1; padding: 15px; background: var(--p); color: #fff; border: none; font-size: 1.1rem; border-radius: 12px; }
    </style>
</head>
<body>

<div class="container">
    <div class="stats">
        <div>–ö–∞—Ä—Ç–∞: <span id="idx">1</span>/255</div>
        <div style="color:#ff8a8a">–ì—Ä–µ—à–∫–∏: <span id="errs">0</span></div>
    </div>

    <div class="panel">
        <div class="btn-group">
            <button type="button" class="tgl" id="m-fc">–ö–∞—Ä—Ç–∏</button>
            <button type="button" class="tgl" id="m-qz">–¢–µ—Å—Ç</button>
            <button type="button" class="tgl" id="m-wr">–ü–∏—Å–∞–Ω–µ</button>
            <button type="button" class="tgl" id="m-ar">–ê—Ä—Ö–∏–≤</button>
        </div>
        <div class="btn-group">
            <button type="button" class="tgl" id="s-bgde">BG ‚ûî DE</button>
            <button type="button" class="tgl" id="s-debg">DE ‚ûî BG</button>
            <button type="button" class="tgl" style="border-color:orange;color:orange" id="btn-shuffle">üîÄ –†–∞–∑–±—ä—Ä–∫–∞–π</button>
        </div>
    </div>

    <div id="ar-area" class="panel" style="display:none">
        <input type="text" id="ar-search" placeholder="–¢—ä—Ä—Å–∏ –≥–ª–∞–≥–æ–ª..." oninput="search()">
        <div id="ar-list"></div>
    </div>

    <div id="fc-area" class="flip-container" onclick="this.classList.toggle('flipped')">
        <div class="flip-inner">
            <div class="card-face" id="f-front"></div>
            <div class="card-face card-back" id="f-back"></div>
        </div>
    </div>

    <div id="main-area" class="main-card">
        <div id="qz-area" style="width:100%">
            <div id="qz-q" style="text-align:center;font-weight:bold;margin-bottom:10px"></div>
            <div id="qz-opts" class="opt-grid"></div>
        </div>
        <div id="wr-area" style="width:100%;display:none">
            <div id="wr-q" style="text-align:center;font-weight:bold;margin-bottom:10px"></div>
            <input type="text" id="wr-i" placeholder="–û—Ç–≥–æ–≤–æ—Ä..." autocomplete="off">
            <div id="wr-msg" style="text-align:center;margin:10px;font-weight:bold"></div>
            <button type="button" class="btn-nav" style="width:100%" id="btn-check-wr">–ü—Ä–æ–≤–µ—Ä–∏</button>
        </div>
    </div>

    <div class="nav" id="nav-btns">
        <button type="button" class="btn-nav" id="btn-prev">‚Üê</button>
        <button type="button" class="btn-nav" id="btn-next">‚Üí –ù–∞–ø—Ä–µ–¥</button>
    </div>
</div>

<script>
const base = [
    {"de":"abbiegen in + A","bg":"–∑–∞–≤–∏–≤–∞–º –Ω–∞"},{"de":"abh√§ng–µ–Ω von + D","bg":"–∑–∞–≤–∏—Å–∏ –æ—Ç"},{"de":"abholen von + D","bg":"–ø–æ—Å—Ä–µ—â–∞–º –æ—Ç"},{"de":"abschreiben von + D","bg":"–ø—Ä–µ–ø–∏—Å–≤–∞–º –æ—Ç"},{"de":"achten auf + A","bg":"–≤–Ω–∏–º–∞–≤–∞–º –∑–∞"},{"de":"am√ºsieren (sich) √ºber + A","bg":"–∑–∞–±–∞–≤–ª—è–≤–∞–º —Å–µ –Ω–∞"},{"de":"anfangen mit + D","bg":"–∑–∞–ø–æ—á–≤–∞–º —Å"},{"de":"ankommen an + D","bg":"–ø—Ä–∏—Å—Ç–∏–≥–∞–º –Ω–∞"},{"de":"ankommen auf + A","bg":"–∑–∞–≤–∏—Å–∏ –æ—Ç"},{"de":"anmelden (sich) bei + D f√ºr + A","bg":"–∑–∞–ø–∏—Å–≤–∞–º —Å–µ –ø—Ä–∏... –∑–∞..."},{"de":"anpassen (sich) an + A","bg":"–Ω–∞–≥–∞–∂–¥–∞–º —Å–µ –∫—ä–º"},{"de":"anrufen bei + D","bg":"–æ–±–∞–∂–¥–∞–º —Å–µ –≤"},{"de":"antworten auf + A","bg":"–æ—Ç–≥–æ–≤–∞—Ä—è–º –Ω–∞"},{"de":"arbeiten an + D","bg":"—Ä–∞–±–æ—Ç—è –≤—ä—Ä—Ö—É"},{"de":"√§rgern (sich) √ºber + A","bg":"—è–¥–æ—Å–≤–∞–º —Å–µ –Ω–∞"},{"de":"aufh√∂ren mit + D","bg":"–ø—Ä–µ—Å—Ç–∞–≤–∞–º —Å"},{"de":"aufpassen auf + A","bg":"–≤–Ω–∏–º–∞–≤–∞–º –∑–∞"},{"de":"aufregen (sich) √ºber + A","bg":"–≤—ä–ª–Ω—É–≤–∞–º —Å–µ –∑–∞"},{"de":"aufsteigen aus + D","bg":"—Å–ª–∏–∑–∞–º –æ—Ç"},{"de":"ausgehen mit + D","bg":"–∏–∑–ª–∏–∑–∞–º —Å"},{"de":"ausgeben f√ºr + A","bg":"—Ö–∞—Ä—á–∞ –∑–∞"},{"de":"√§u√üern (sich) √ºber + A","bg":"–∏–∑–∫–∞–∑–≤–∞–º —Å–µ –∑–∞"},{"de":"basieren auf + D","bg":"–±–∞–∑–∏—Ä–∞–º —Å–µ –Ω–∞"},{"de":"bedanken (sich) bei + D f√ºr + A","bg":"–±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–∞... –∑–∞..."},{"de":"befassen (sich) mit + D","bg":"–∑–∞–Ω–∏–º–∞–≤–∞–º —Å–µ —Å"},{"de":"begeistern (sich) f√ºr + A","bg":"–≤—ä–æ–¥—É—à–µ–≤—è–≤–∞–º —Å–µ –∑–∞"},{"de":"beginnen mit + D","bg":"–∑–∞–ø–æ—á–≤–∞–º —Å"},{"de":"beitragen zu + D","bg":"–¥–æ–ø—Ä–∏–Ω–∞—Å—è–º –∑–∞"},{"de":"beklagen (sich) bei + D √ºber + A","bg":"–æ–ø–ª–∞–∫–≤–∞–º —Å–µ –Ω–∞... –æ—Ç..."},{"de":"bem√ºhen (sich) um + A","bg":"—Å—Ç–∞—Ä–∞—è —Å–µ –∑–∞"},{"de":"beneiden um + A","bg":"–∑–∞–≤–∏–∂–¥–∞–º –∑–∞"},{"de":"benennen nach + D","bg":"–Ω–∞–∑–æ–≤–∞–≤–∞–º –Ω–∞"},{"de":"berichten √ºber + A","bg":"—Å—ä–æ–±—â–∞–≤–∞–º –∑–∞"},{"de":"beruhen auf + D","bg":"–æ—Å–Ω–æ–≤–∞–≤–∞–º —Å–µ –Ω–∞"},{"de":"besch√§ftigen (sich) mit + D","bg":"–∑–∞–Ω–∏–º–∞–≤–∞–º —Å–µ —Å"},{"de":"beschweren (sich) bei + D √ºber + A","bg":"–æ–ø–ª–∞–∫–≤–∞–º —Å–µ –Ω–∞... –æ—Ç..."},{"de":"bestehen aus + D","bg":"—Å—ä—Å—Ç–æ—è —Å–µ –æ—Ç"},{"de":"bestehen auf + D","bg":"–Ω–∞—Å—Ç–æ—è–≤–∞–º –Ω–∞"},{"de":"beteiligen (sich) an + D","bg":"—É—á–∞—Å—Ç–≤–∞–º –≤"},{"de":"bewahren vor + D","bg":"–ø–∞–∑—è –æ—Ç"},{"de":"bewerben (sich) um + A","bg":"–∫–∞–Ω–¥–∏–¥–∞—Ç—Å—Ç–≤–∞–º –∑–∞"},{"de":"beziehen (sich) auf + A","bg":"–æ—Ç–Ω–∞—Å—è–º —Å–µ –¥–æ"},{"de":"binden (sich) an + A","bg":"–æ–±–≤—ä—Ä–∑–≤–∞–º —Å–µ —Å"},{"de":"bitten um + A","bg":"–º–æ–ª—è –∑–∞"},{"de":"danken f√ºr + A","bg":"–±–ª–∞–≥–æ–¥–∞—Ä—è –∑–∞"},{"de":"denken an + A","bg":"–º–∏—Å–ª—è –∑–∞"},{"de":"dienen als / zu + D","bg":"—Å–ª—É–∂–∞ –∫–∞—Ç–æ / –∑–∞"},{"de":"diskutieren √ºber + A","bg":"–¥–∏—Å–∫—É—Ç–∏—Ä–∞–º –∑–∞"},{"de":"eignen (sich) f√ºr + A","bg":"–ø–æ–¥—Ö–æ–¥—è—â —Å—ä–º –∑–∞"},{"de":"einladen zu + D","bg":"–∫–∞–Ω—è –Ω–∞"},{"de":"einlassen (sich) auf + A","bg":"–≤–ø—É—Å–∫–∞–º —Å–µ –≤"},{"de":"einsteigen in + A","bg":"–∫–∞—á–≤–∞–º —Å–µ –≤"},{"de":"einverstanden sein mit + D","bg":"—Å—ä–≥–ª–∞—Å–µ–Ω —Å—ä–º —Å"},{"de":"ekeln (sich) vor + D","bg":"–æ—Ç–≤—Ä–∞—â–∞–≤–∞–º —Å–µ –æ—Ç"},{"de":"emp√∂ren (sich) √ºber + A","bg":"–≤—ä–∑–º—É—â–∞–≤–∞–º —Å–µ –æ—Ç"},{"de":"entscheiden (sich) f√ºr + A","bg":"—Ä–µ—à–∞–≤–∞–º —Å–µ –∑–∞"},{"de":"entschlie√üen (sich) zu + D","bg":"—Ä–µ—à–∞–≤–∞–º —Å–µ –Ω–∞"},{"de":"entschuldigen (sich) bei + D f√ºr + A","bg":"–∏–∑–≤–∏–Ω—è–≤–∞–º —Å–µ –Ω–∞... –∑–∞..."},{"de":"erfahren √ºber + A","bg":"–Ω–∞—É—á–∞–≤–∞–º –∑–∞"},{"de":"erinnern an + A","bg":"—Å–ø–æ–º–Ω—è–º —Å–∏ –∑–∞"},{"de":"erkennen an + D","bg":"—Ä–∞–∑–ø–æ–∑–Ω–∞–≤–∞–º –ø–æ"},{"de":"erkundigen (sich) bei + D nach + D","bg":"–æ—Å–≤–µ–¥–æ–º—è–≤–∞–º —Å–µ –æ—Ç... –∑–∞..."},{"de":"ersetzen durch + A","bg":"–∑–∞–º–µ–Ω—è–º —Å"},{"de":"erschrecken vor + D","bg":"—É–ø–ª–∞—à–≤–∞–º —Å–µ –æ—Ç"},{"de":"erz√§hlen √ºber + A / von + D","bg":"—Ä–∞–∑–∫–∞–∑–≤–∞–º –∑–∞"},{"de":"es geht um + A","bg":"—Å—Ç–∞–≤–∞ –¥—É–º–∞ –∑–∞"},{"de":"fliehen vor + D","bg":"–±—è–≥–∞–º –æ—Ç"},{"de":"folgen aus + D","bg":"—Å–ª–µ–¥–≤–∞ –æ—Ç"},{"de":"fragen nach + D","bg":"–ø–∏—Ç–∞–º –∑–∞"},{"de":"freuen (sich) auf + A","bg":"—Ä–∞–¥–≤–∞–º —Å–µ –Ω–∞ (–±—ä–¥–µ—â–µ)"},{"de":"freuen (sich) √ºber + A","bg":"—Ä–∞–¥–≤–∞–º —Å–µ –Ω–∞ (–º–∏–Ω–∞–ª–æ/—Å–µ–≥–∞)"},{"de":"f√ºhren zu + D","bg":"–≤–æ–¥—è –¥–æ"},{"de":"f√ºrchten (sich) vor + D","bg":"–±–æ—è —Å–µ –æ—Ç"},{"de":"geh√∂ren zu + D","bg":"–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞ –∫—ä–º"},{"de":"gew√∂hnen (sich) an + A","bg":"—Å–≤–∏–∫–≤–∞–º —Å"},{"de":"gewinnen an + D","bg":"–ø–µ—á–µ–ª—è –æ—Ç–∫—ä–º"},{"de":"glauben an + A","bg":"–≤—è—Ä–≤–∞–º –≤"},{"de":"grenzen an + A","bg":"–≥—Ä–∞–Ω–∏—á–∞ —Å"},{"de":"halten (sich) an + A","bg":"–ø—Ä–∏–¥—ä—Ä–∂–∞–º —Å–µ –∫—ä–º"},{"de":"halten f√ºr + A","bg":"—Å—á–∏—Ç–∞–º –∑–∞"},{"de":"handeln von + D","bg":"—Ä–∞–∑–∫–∞–∑–≤–∞ –∑–∞"},{"de":"handeln (sich) um + A","bg":"–∫–∞—Å–∞–µ —Å–µ –∑–∞"},{"de":"handeln mit + D","bg":"—Ç—ä—Ä–≥—É–≤–∞–º —Å"},{"de":"helfen bei + D","bg":"–ø–æ–º–∞–≥–∞–º –ø—Ä–∏"},{"de":"herrschen √ºber + A","bg":"–≥–æ—Å–ø–æ–¥—Å—Ç–≤–∞–º –Ω–∞–¥"},{"de":"hinweisen auf + A","bg":"–ø–æ—Å–æ—á–≤–∞–º / –æ–±—Ä—ä—â–∞–º –≤–Ω–∏–º–∞–Ω–∏–µ"},{"de":"hoffen auf + A","bg":"–Ω–∞–¥—è–≤–∞–º —Å–µ –Ω–∞"},{"de":"h√∂ren von + D","bg":"—á—É–≤–∞–º –∑–∞"},{"de":"informieren (sich) √ºber + A","bg":"–∏–Ω—Ñ–æ—Ä–º–∏—Ä–∞–º —Å–µ –∑–∞"},{"de":"interessieren (sich) f√ºr + A","bg":"–∏–Ω—Ç–µ—Ä–µ—Å—É–≤–∞–º —Å–µ –æ—Ç"},{"de":"investieren in + A","bg":"–∏–Ω–≤–µ—Å—Ç–∏—Ä–∞–º –≤"},{"de":"k√§mpfen f√ºr + A / gegen + A","bg":"–±–æ—Ä—è —Å–µ –∑–∞ / —Å—Ä–µ—â—É"},{"de":"klagen √ºber + A","bg":"–æ–ø–ª–∞–∫–≤–∞–º —Å–µ –æ—Ç"},{"de":"konzentrieren (sich) auf + A","bg":"–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–∞–º —Å–µ –≤—ä—Ä—Ö—É"},{"de":"k√ºmmern (sich) um + A","bg":"–≥—Ä–∏–∂–∞ —Å–µ –∑–∞"},{"de":"lachen √ºber + A","bg":"—Å–º–µ—è —Å–µ –Ω–∞"},{"de":"l√§cheln √ºber + A","bg":"—É—Å–º–∏—Ö–≤–∞–º —Å–µ –Ω–∞"},{"de":"leiden an + D / unter + D","bg":"—Å—Ç—Ä–∞–¥–∞–º –æ—Ç (–±–æ–ª–µ—Å—Ç / –æ–±—Å—Ç.)"},{"de":"liegen an + D","bg":"–¥—ä–ª–∂–∏ —Å–µ –Ω–∞"},{"de":"mangeln an + D","bg":"–ª–∏–ø—Å–∞ –Ω–∞"},{"de":"meinen zu + D","bg":"–∏–º–∞–º –º–Ω–µ–Ω–∏–µ –∑–∞"},{"de":"melden (sich) bei + D","bg":"–æ–±–∞–∂–¥–∞–º —Å–µ –Ω–∞"},{"de":"nachdenken √ºber + A","bg":"—Ä–∞–∑–º–∏—à–ª—è–≤–∞–º –≤—ä—Ä—Ö—É"},{"de":"nachschlagen in + D","bg":"–ø—Ä–æ–≤–µ—Ä—è–≤–∞–º –≤"},{"de":"nutzen als + N","bg":"–∏–∑–ø–æ–ª–∑–≤–∞–º –∫–∞—Ç–æ"},{"de":"passen zu + D","bg":"–ø–∞—Å–≤–∞ –Ω–∞"},{"de":"profitieren von + D","bg":"–ø–µ—á–µ–ª—è –æ—Ç"},{"de":"r√§chen (sich) an + D","bg":"–æ—Ç–º—ä—â–∞–≤–∞–º —Å–∏ –Ω–∞"},{"de":"reagieren auf + A","bg":"—Ä–µ–∞–≥–∏—Ä–∞–º –Ω–∞"},{"de":"rechnen mit + D","bg":"—Ä–∞–∑—á–∏—Ç–∞–º –Ω–∞ / –ø—Ä–µ–¥–≤–∏–∂–¥–∞–º"},{"de":"reden √ºber + A","bg":"–≥–æ–≤–æ—Ä—è –∑–∞"},{"de":"rett–µ–Ω vor + D","bg":"—Å–ø–∞—Å—è–≤–∞–º –æ—Ç"},{"de":"riechen nach + D","bg":"–º–∏—Ä–∏—à–µ –Ω–∞"},{"de":"richten (sich) nach + D","bg":"—Å—ä–æ–±—Ä–∞–∑—è–≤–∞–º —Å–µ —Å"},{"de":"sagen zu + D","bg":"–∫–∞–∑–≤–∞–º –Ω–∞"},{"de":"sch√§men (sich) vor + D","bg":"—Å—Ä–∞–º—É–≤–∞–º —Å–µ –æ—Ç"},{"de":"schauen auf + A","bg":"–≥–ª–µ–¥–∞–º –∫—ä–º"},{"de":"schimpfen √ºber + A / mit + D","bg":"—Ä—É–≥–∞—è –∑–∞ / –∫–∞—Ä–∞–º —Å–µ –Ω–∞"},{"de":"schmecken nach + D","bg":"–∏–º–∞ –≤–∫—É—Å –Ω–∞"},{"de":"schreiben an + A","bg":"–ø–∏—à–∞ –Ω–∞"},{"de":"schuld sein an + D","bg":"–≤–∏–Ω–æ–≤–µ–Ω –∑–∞"},{"de":"sch√ºtzen vor + D","bg":"–ø–∞–∑—è –æ—Ç"},{"de":"sehnen (sich) nach + D","bg":"–∫–æ–ø–Ω–µ—è –∑–∞"},{"de":"siegen √ºber + A","bg":"–ø–æ–±–µ–∂–¥–∞–≤–∞–º –Ω–∞–¥"},{"de":"sorgen f√ºr + A","bg":"–≥—Ä–∏–∂–∞ —Å–µ –∑–∞"},{"de":"spezialisieren (sich) auf + A","bg":"—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–º —Å–µ –≤"},{"de":"sprechen mit + D / √ºber + A","bg":"–≥–æ–≤–æ—Ä—è —Å / –∑–∞"},{"de":"stammen aus + D","bg":"–ø—Ä–æ–∏–∑—Ö–æ–∂–¥–∞–º –æ—Ç"},{"de":"staunen √ºber + A","bg":"–¥–∏–≤—è —Å–µ –Ω–∞"},{"de":"sterben an + D","bg":"—É–º–∏—Ä–∞–º –æ—Ç"},{"de":"sto√üen auf + A","bg":"–Ω–∞—Ç—ä–∫–≤–∞–º —Å–µ –Ω–∞"},{"de":"st√∂ren bei + D","bg":"–ø—Ä–µ—á–∞ –ø—Ä–∏"},{"de":"streiten (sich) mit + D","bg":"–∫–∞—Ä–∞–º —Å–µ —Å"},{"de":"suchen nach + D","bg":"—Ç—ä—Ä—Å—è –Ω–µ—â–æ"},{"de":"telefonieren mit + D","bg":"–≥–æ–≤–æ—Ä—è –ø–æ —Ç–µ–ª. —Å"},{"de":"teilnehmen an + D","bg":"—É—á–∞—Å—Ç–≤–∞–º –≤"},{"de":"tr√§umen von + D","bg":"–º–µ—á—Ç–∞—è –∑–∞"},{"de":"trennen (sich) von + D","bg":"—Ä–∞–∑–¥–µ–ª—è–º —Å–µ –æ—Ç"},{"de":"treffen (sich) mit + D","bg":"—Å—Ä–µ—â–∞–º —Å–µ —Å"},{"de":"trinken auf + A","bg":"–ø–∏—è –∑–∞ –∑–¥—Ä–∞–≤–µ"},{"de":"√ºberreden zu + D","bg":"–ø—Ä–∏–¥—É–º–≤–∞–º –∫—ä–º"},{"de":"√ºberzeugen (sich) von + D","bg":"—É–±–µ–∂–¥–∞–≤–∞–º —Å–µ –≤"},{"de":"umdrehen (sich) nach + D","bg":"–æ–±—Ä—ä—â–∞–º —Å–µ —Å–ª–µ–¥"},{"de":"umgeben von + D","bg":"–∑–∞–æ–±–∏–∫–æ–ª–µ–Ω –æ—Ç"},{"de":"unterhalten (sich) mit + D","bg":"—Ä–∞–∑–≥–æ–≤–∞—Ä—è–º —Å"},{"de":"unterscheiden (sich) von + D","bg":"—Ä–∞–∑–ª–∏—á–∞–≤–∞–º —Å–µ –æ—Ç"},{"de":"verabschieden (sich) von + D","bg":"—Å–±–æ–≥—É–≤–∞–º —Å–µ —Å"},{"de":"vergleichen mit + D","bg":"—Å—Ä–∞–≤–Ω—è–≤–∞–º —Å"},{"de":"verf√ºgen √ºber + A","bg":"—Ä–∞–∑–ø–æ–ª–∞–≥–∞–º —Å"},{"de":"verlassen (sich) auf + A","bg":"—Ä–∞–∑—á–∏—Ç–∞–º –Ω–∞"},{"de":"verlieben (sich) in + A","bg":"–≤–ª—é–±–≤–∞–º —Å–µ –≤"},{"de":"verstehen von + D","bg":"—Ä–∞–∑–±–∏—Ä–∞–º –æ—Ç"},{"de":"verzichten auf + A","bg":"–æ—Ç–∫–∞–∑–≤–∞–º —Å–µ –æ—Ç"},{"de":"verzweifeln an + D","bg":"–æ—Ç—á–∞–π–≤–∞–º —Å–µ –æ—Ç"},{"de":"vorbeifahren an + D","bg":"–º–∏–Ω–∞–≤–∞–º –ø–æ–∫—Ä–∞–π (–ú–ü–°)"},{"de":"vorbeigehen an + D","bg":"–º–∏–Ω–∞–≤–∞–º –ø–æ–∫—Ä–∞–π (–ø–µ—à–∞)"},{"de":"vorbereiten (sich) auf + A","bg":"–ø–æ–¥–≥–æ—Ç–≤—è–º —Å–µ –∑–∞"},{"de":"warten auf + A","bg":"—á–∞–∫–∞–º –∑–∞"},{"de":"warnen vor + D","bg":"–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–≤–∞–º –∑–∞"},{"de":"weinen √ºber + A","bg":"–ø–ª–∞—á–∞ –∑–∞"},{"de":"wenden (sich) an + A","bg":"–æ–±—Ä—ä—â–∞–º —Å–µ –∫—ä–º"},{"de":"wissen √ºber + A","bg":"–∑–Ω–∞—è –∑–∞"},{"de":"wundern (sich) √ºber + A","bg":"—á—É–¥—è —Å–µ –Ω–∞"},{"de":"zeugen von + D","bg":"—Å–≤–∏–¥–µ—Ç–µ–ª—Å—Ç–≤–∞–º –∑–∞"},{"de":"zittern vor + D","bg":"—Ç—Ä–µ–ø–µ—Ä—è –æ—Ç"},{"de":"zusammenh√§ngen mit + D","bg":"—Å–≤—ä—Ä–∑–∞–Ω –µ —Å"},{"de":"zweifeln an + D","bg":"—Å—ä–º–Ω—è–≤–∞–º —Å–µ –≤"}
];

let data = [...base], idx = 0, errs = 0, mode = 'fc', side = 'bgde', busy = false;

function clr(t) { 
    if(!t) return "";
    return t.replace(/\+ A/g,'<span class="txt-akk">+ A</span>').replace(/\+ D/g,'<span class="txt-dat">+ D</span>'); 
}

function render() {
    const item = data[idx];
    document.getElementById('idx').innerText = idx + 1;
    document.getElementById('errs').innerText = errs;
    busy = false;

    const q = side==='bgde'?item.bg:item.de;
    const a = side==='bgde'?item.de:item.bg;

    if(mode==='fc') {
        document.getElementById('fc-area').classList.remove('flipped');
        document.getElementById('f-front').innerHTML = side==='bgde'?q:clr(q);
        document.getElementById('f-back').innerHTML = side==='bgde'?clr(a):a;
    } else if(mode==='qz') {
        document.getElementById('qz-q').innerHTML = side==='bgde'?q:clr(q);
        const pool = base.map(i => side==='bgde'?i.de:i.bg);
        const opts = [a, ...pool.filter(x=>x!==a).sort(()=>.5-Math.random()).slice(0,3)].sort(()=>.5-Math.random());
        const box = document.getElementById('qz-opts');
        box.innerHTML = '';
        opts.forEach(o => {
            const b = document.createElement('button');
            b.className = 'opt'; b.innerHTML = side==='bgde'?clr(o):o;
            b.onclick = () => {
                if(busy) return; busy = true;
                if(o === a) { b.classList.add('correct'); setTimeout(()=>move(1), 600); }
                else { b.classList.add('wrong'); errs++; document.getElementById('errs').innerText = errs; setTimeout(()=>busy=false, 1000); }
            };
            box.appendChild(b);
        });
    } else if(mode==='wr') {
        document.getElementById('wr-q').innerHTML = side==='bgde'?q:clr(q);
        document.getElementById('wr-i').value = '';
        document.getElementById('wr-msg').innerText = '';
    }
}

function checkWr() {
    const a = side==='bgde'?data[idx].de:data[idx].bg;
    const inp = document.getElementById('wr-i').value.trim().toLowerCase().replace(/\s?\+\s?/g,'+');
    const target = a.toLowerCase().replace(/\s?\+\s?/g,'+');
    if(inp === target) {
        document.getElementById('wr-msg').innerHTML = '<span style="color:var(--ok)">‚úÖ –í—è—Ä–Ω–æ</span>';
        setTimeout(()=>move(1), 800);
    } else {
        document.getElementById('wr-msg').innerHTML = `<span style="color:var(--err)">‚ùå ${clr(a)}</span>`;
        errs++; document.getElementById('errs').innerText = errs;
    }
}

function move(s) { idx = (idx+s+data.length)%data.length; render(); }
function shuffle() { data.sort(()=>.5-Math.random()); idx=0; render(); }

function search() {
    const t = document.getElementById('ar-search').value.toLowerCase();
    const list = document.getElementById('ar-list');
    list.innerHTML = [...base].sort((a,b)=>a.de.localeCompare(b.de))
        .filter(i => i.de.toLowerCase().includes(t) || i.bg.toLowerCase().includes(t))
        .map(i => `<div class="ar-item"><strong>${clr(i.de)}</strong><span style="font-size:0.8rem;color:#666">${i.bg}</span></div>`).join('');
}

// –ü—Ä–∏–∫—Ä–µ–ø—è–Ω–µ –Ω–∞ —Å—ä–±–∏—Ç–∏—è
document.getElementById('btn-next').onclick = () => move(1);
document.getElementById('btn-prev').onclick = () => move(-1);
document.getElementById('btn-shuffle').onclick = () => shuffle();
document.getElementById('btn-check-wr').onclick = () => checkWr();

document.querySelectorAll('.tgl').forEach(btn => {
    btn.addEventListener('click', () => {
        const id = btn.id;
        if(id.startsWith('m-')) {
            mode = id.split('-')[1];
            document.getElementById('ar-area').style.display = mode==='ar'?'block':'none';
            document.getElementById('fc-area').style.display = mode==='fc'?'block':'none';
            document.getElementById('main-area').style.display = (mode==='qz'||mode==='wr')?'flex':'none';
            document.getElementById('qz-area').style.display = mode==='qz'?'block':'none';
            document.getElementById('wr-area').style.display = mode==='wr'?'block':'none';
            document.getElementById('nav-btns').style.display = mode==='ar'?'none':'flex';
            if(mode==='ar') search();
        } else { side = id.split('-')[1]; }
        document.querySelectorAll('.tgl').forEach(b => b.classList.toggle('active', b.id==='m-'+mode || b.id==='s-'+side));
        render();
    });
});

window.onload = () => {
    document.getElementById('m-fc').classList.add('active');
    document.getElementById('s-bgde').classList.add('active');
    render();
};
</script>
</body>
</html>
